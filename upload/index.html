<!-- 一个图片预览上传的示例 -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <label for="file" class="button">
        选取文件
        <input type="file" id="file">
    </label>
    <div id="snapshot"></div>
    <button class="submit"> 提交 </button>
</body>
<script>
    var file;
    var el = document.querySelector('#file')
    var snapshot = document.querySelector('#snapshot')
    el.addEventListener('change', function (e) {
        file = e.target.files[0]
        var image = new Image(300, 300)
        var fileReader = new FileReader()
        fileReader.readAsDataURL(file)
        fileReader.onload = function () {
            image.src = fileReader.result
            snapshot.appendChild(image)
        }
    })
    
    var button = document.querySelector('.submit')
    button.addEventListener('click', function () {
        var xhr = new XMLHttpRequest()
        var formData = new FormData()
        formData.append('file', file)
        // ...
        formData.append('some_key', 'some_value')

        xhr.open('POST', 'http://localhost:8080/api/tickets/create')
        xhr.setRequestHeader('Authorization', 'some_auth_token')
        xhr.send(formData)
        xhr.onload = function () {
            if (this.status === 200) {
                console.log('上传成功')
            } else {
                console.error('上传失败', this.status)
            }
        }
    })
</script>
<style>
    #file {
        display: none;
    }
    label.button {
        -webkit-appearance: button;
        appearance: button;
        margin-bottom: 8px;
    }
</style>
</html>